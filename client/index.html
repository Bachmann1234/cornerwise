<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="description" content="City of Somerville planning reports and capital projects">
    <title>Cornerwise</title>
    <script data-main="/static/scripts/main" src="/static/scripts/require.js"></script>
    <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.3/leaflet.css" />
    <link rel="stylesheet" href="/static/css/app.css" type="text/css" media="screen" />
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Template for proposals in the proposal table -->
    <script type="text/template" id="proposal-template">
      <td><%- proposal.address %></td>
      <td>
        <b><%- proposal.summary %></b>
        <br>Case: <%- proposal.caseNumber %></td>
      <td>
        <span class="distance"><%= commas(proposal.refDistance) %> feet</span>
      </td>
    </script>



<script type="text/template" id="proposal-details">
  <div class="details">
    <a href="#" class="close">Close</a>
    <h4>
      <div class="minimap"></div>
      <%- proposal.address %>
    </h4>
    <div class="case-number"><%- proposal.caseNumber %></div>

    <% if (proposal.attributes && proposal.attributes.length) { %>
    <table class="attributes section table">
      <% _.each(proposal.attributes, function(attr) { %>
      <tr class="attribute">
        <th scope="row"><%- attr.name %>:</th>
        <td><%- attr.value %></td>
      </tr>
      <% }); %>
    </table>
    <% } %>

    <% if (proposal.documents && proposal.documents.length) { %>
    <div class="documents section">
      <div class="section-title">Documents</div>
      <% _.each(proposal.documents.slice(0, 10), function(doc) { %>
      <a class="document" href="<%= doc.url %>" target="_blank">
        <% if (doc.thumb) { %>
        <img class="thumb" src="<%- doc.thumb %>"/>
        <% } else { %>
        <div class="dummy-thumb thumb">Doc</div>
        <% } %>
        <div class="title"><%- doc.title %></div>
      </a>
      <% }); %>
    </div>
    <% } %>

    <% if (proposal.images && proposal.images.length) { %>
    <div class="images section">
      <div class="section-title">Images</div>
      <% _.each(proposal.images.slice(0, 10), function(img) { %>
      <a class="thumb-link" href="<%= img.src %>" target="_blank">
        <img class="thumb" src="<%= img.thumb || img.src %>"/>
      </a>
      <% }); %>
    </div>
    <% } %>

    <% if (proposal.parcel) { %>
    <% with(proposal.parcel) { %>
    <div class="section">
      <div class="section-title">
        Parcel
      </div>

      <table class="table">
        <tr>
          <td>Lot Size:</td>
          <td><%- properties.LOT_SIZE %> acres</td>
        </tr>
        <tr>
          <td>Residential Area</td>
          <td><%- commas(properties.RES_AREA) %> square feet</td>
        </tr>
      </table>
    </div>
    <% } %>
    <% } %>
  </div>
    </script>

    <script type="text/template" id="project-template">
      <div class="icon">
        <img src="<%- project.thumbnail() %>">
      </div>
      <div class="name" title="<%- project.get('name') %>">
        <%- project.get("name") %>
      </div>
      <div class="category" title="<%- project.get('category') %>">
        <img src="<%- project.categoryIcon() %>"/>
      </div>
      <div class="department"><%- project.get("department") %></div>
      <div class="time-span"></div>
      <div class="status">
        <div class="<%- project.get('approved') ? 'approved' : 'pending' %>"/>
      </div>
      <div class="budget">
        <%- prettyAmount(project.totalBudget()) %>
        <% var years = project.yearRange();
           if (years[0] == years[1]) {
        %>
        in <span class="budget-year"><%- years[0] %></span>
        <% } else { %>
        ~
        <span class="budget-years">
          <%- years[0] %>&ndash;<%= years[1] %>
        </span>
        <% } %>
      </div>
      <div class="status <%- project.get('approved') ? 'approved' : '' %>">
        <% if (project.get("approved")) { %>
        ✓ Approved
        <% } else { %>
        ⚙ Pending Review
        <% } %>
      </div>
    </script>

    <script type="text/template" id="proposal-preview-template">
      <div>
        <img src="<%- proposal.getThumb() %>" class="thumb"/>
        <h3 class="address"><%= proposal.get("address") %></h3>
        <div class="applicant">
          <%
             var applicant = proposal.getAttributeValueOrFetch("applicant_name"),
             notice = proposal.getAttributeValue("legal_notice"),
             owner = proposal.getAttributeValue("owner_name");
             if (applicant) {
             %>
          <div class="applicant-name"> <%= applicant %> (applicant)</div>
          <% }
             if (owner) {
             %>
          <div class="applicant-name"> <%= owner %> (owner) </div>
          <%
             }
             if (notice) {
             %>
          <div class="legal-notice"><%= notice %></div>
          <% } %>
        </div>
        <div id="details-minimap"></div>

        <div class="controls">
          <a class="more" href="#">View more&hellip;</a>
          <a class="calendar" aria-label="View related event" href="#">
            <img src="/static/images/calendar.png">
          </a>
        </div>
      </div>
    </script>

    <script type="text/template" id="project-preview-template">
      <h3><%- project.get("name") %></h3>
      <div class="category"><%- project.get("category") %></div>
      <div class="department"><%- project.departmentName() %></div>
      <div class="desription">
        Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.
      </div>

      <strong>Budget:</strong>
      <svg class="budget-chart" height="90" width="300"/>
    </script>

  </head>
    <body>
      <div id="map-container">
        <div id="map"></div>
        <div id="minimap"></div>

        <!-- container for preview of selected proposal/project -->
        <div id="preview"></div>

        <!-- container for detail view -->
        <div id="overlay"></div>
      </div>

      <div id="search-banner" class="overlay">
        <div id="logo" class="resp-portrait-hide"></div>
        <div class="overlay-contents">
          <h3>what&rsquo;s being built near&hellip;</h3>
          <div class="input-group big-input">
            <form id="ref-address-form">
              <input class="input" type="text" name="address" placeholder="enter address" autocomplete="off"/>
              <img src="/static/images/geolocating.gif" class="status" alt="searching" />
              <button type="submit" class="input-button go-button">go</button>
            </form>
          </div>
        </div>
        <a id="geolocate" href="#">Near Me</a>
        <a id="explore" href="#">Explore the Data</a>
      </div>

      <div id="menu">
        <a id="menu-button" class="button big" href="#">
          <span class="icon" aria-hidden="true">≡</span>
          <span class="resp-portrait-hide">MENU</span>
        </a>
      </div>

      <div id="data" class="collapsed">
        <div id="data-controls">
          <a href="#" id="expand-data" class="when-collapsed">Explore &larr;</a>
          <a href="#" id="collapse-data" class="when-expanded">Hide &rarr;</a>
        </div>
        <div class="tabs"></div>
        <div class="tab-pane">
        </div>
      </div>

      <div id="intro" class="overlay">
        <div class="section">
          <h3>PLANNING AND ZONING</h3>

          <ul>
            <li>current building projects</li>
            <li>building requests</li>
            <li>variances</li>
            <li>schedule of public hearings</li>
          </ul>

          <div class="more">
            <a href="#">Learn more</a>
          </div>
        </div>
        <div class="section">
          <h3>CITY INITIATIVES</h3>

          <div class="lede">
            <h4>GREEN LINE EXTENSION</h4>

            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec
            a diam lectus. Sed sit amet ipsum mauris.
            <br><br>
            <a class="_details" href="#">Details</a>
          </div>
        </div>
      </div>

      <div id="controls" class="overlay">
        <div class="section">
          <h3>FILTER</h3>
          <a href="#" class="filter-button">Project Type</a>
          <a href="#" class="filter-button">Something Else</a>
          <a href="#" class="filter-button">Impact</a>
        </div>
        <div class="section"></div>
        <div id="signup" class="section">
          <!-- <span class="resp-portrait-hide"> -->
          <!--   Sign up for alerts near this address: -->
          <!-- </span> -->
          <a id="subscribe" class="big button">SUBSCRIBE</a>
          <!-- <div class="input-group"> -->

          <!-- <input class="input" type="text" name="address" placeholder="enter email" /> -->
          <!-- <button class="input-button go-button">go</button> -->
          <!-- </div> -->
        </div>
      </div>
    </body>
</html>
